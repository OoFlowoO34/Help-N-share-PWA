<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}Welcome!{% endblock %}</title>
        <link rel="icon" href="{{ asset('photos/S_logo.png') }}" >
        
        {# Run `composer require symfony/webpack-encore-bundle` to start using Symfony UX #}
        {% block stylesheets %}
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
            <link rel="stylesheet" href="{{ asset('style.css') }}">
            <link rel="preconnect" href="https://fonts.googleapis.com">
            <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
            <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            {{ encore_entry_link_tags('app') }}
        {% endblock %}

        {% block javascripts %}
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
            {{ encore_entry_script_tags('app') }}

        {% endblock %}
    </head>
    <body>
        {% include "partials/nav.html.twig" %}
        {% block body %}

        {% endblock %}
        <script>
            
        // Get a NodeList of all .demo elements
        const demoClasses = document.querySelectorAll('.nav-brand');
        const lulu = document.getElementById("idtest");
        // Change the text of multiple elements with a loop
        demoClasses.forEach(element => {
            
           
                lulu.addEventListener("mouseover", test);

                function test(){
                element.setAttribute("fill", "#0D6EFD")
                console.log("brand blue")
                }

                lulu.addEventListener("mouseout", leave);

                function leave(){
               
                element.setAttribute("fill", "white")
                console.log("brand white")
            }
        });
            
  
        // AJAX
        
        {# fetch('https://127.0.0.1:8000/like')
        .then(r => r.json())
        .then(body => console.log(body))
         #}

        const jsLikes = document.querySelectorAll(".js-like");
        {# const js-likes = document.getElementsByClassName("js-like"); #}
        console.log(jsLikes);

        function onClickBtnLike(event){

            //prevents the page refresh
            event.preventDefault();
            const url = this.href; 
            const jsLikesLength = this.querySelector('.js-likes-length');
            const icone = this.querySelector('.fa-thumbs-up');
            if(icone.classList.contains("fa-solid")){
                icone.classList.replace("fa-solid","fa-regular")
            }
            else{
                icone.classList.replace("fa-regular","fa-solid")
            }
            console.log(url);

            fetch(url)
            .then(response => response.json())
            .then(function(response){
                // console.log(response)
                // console.log(this)
                // console.log(response.likes)
                // console.log(jsLikesLength)
                if(response.countLiked !== 0){
                    console.log("test")
                    jsLikesLength.textContent = response.countLiked;
                }
                else{
                    jsLikesLength.textContent = "";
                }
            })
            
            
            
         
        }

        jsLikes.forEach(function(link){
            console.log("jsLikes");
            link.addEventListener('click', onClickBtnLike);
        })


        </script>

    </body>
</html>
